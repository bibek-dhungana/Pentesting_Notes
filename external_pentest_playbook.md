# This repo contains the notes that can be used as an external pentest checklist. The notes below are taken from the course The External Pentest Playbook From TCM Security.

# Introduction
- Trying to hack into an organization from outside of that organizationâ€™s network.
- External pentest heavily rely on open source intelligence and information gathering.

# Objectives of External Pentest
- Trying to test the security from the outside perspective.
- To protect the client from external threats.

# Checklist
- There is also the checklist provided by heath adams in xlsx format:
  - https://github.com/hmaverickadams/External-Pentest-Checklist/blob/main/TCMS%20-%20External%20Pentest%20Checklist.xlsx

# Rules of engagements
- The rules of the engagements & overall scope , roles , responsibilities of the service provider + client are defined in ROE.

# Verifying scope
- Verifying the given scope by the client before starting the assessment.

# Client Communication
- Time to time communication to the client point of contact is necessary in case of critical findings or other necessities.

# Attack Strategy
- Think of external pentests like home security
- Low chance of RCE, high chance of weak passwords.
- OSINT is your best friend ( and logical guessing)

# Vulnerability scanning
- Scanning the target IP ranges/addresses using tools like nessus.

# Reviewing and Extracting Information
- Reviewing the findings & infromation of the vulnerability scanning from the nessus or other scanners.
- Export the scan result as a .nessus file & parse it via avaliable nessus parsers.

# OSINT Overview
- Osint overview defines the publicly avaliable information that can leverage an attack.

# Hunting Breached Credentials
- While performing external penetration testing, breached credentials is very much useful to leverage an attack that help to access the internal system.
- Some resources are:
  - https://github.com/hmaverickadams/breach-parse

- Paid resource to get the breached credentials:
  - https://www.dehashed.com/

# Identifying Emails & employees
- There are certain tools to get the specific organization emails such as:
 - Chrome extension to collect organization email via gmail:
   - https://connect.clearbit.com/
  
 - Handy site to collect company/organization based email addresses:
   - https://phonebook.cz/

# Enumerating Valid Accounts ( Pre-Attack):
- More Valid emails can be gathered  via  the organization web application , social media handles and other open source data.
- Enumerating the password policy via the login portals , signup forms, documentations etc.

# Other Useful Information:
- Quick Tip: Visiting the target/client website & reading different policies & documentations can sometimes reveals the juicy information about the target such as password policies , technologies used & many more.

# Attacking Login Portals (overview):
- At this point,you should have identified:
  - Login portals to attack
  - List of possible employees/emails
  - Password strategies to employ.

- With the above information, we will mostly focusing on attacking office 365 at first.

# Password Spraying O365
- This tool is capable of spraying password over O365 & other login portals along with the proxy options & time delay features with it. Follow the link below for the usage provided in official repo.
  - https://github.com/blacklanternsecurity/TREVORspray

# Password Spraying OWA (Outlook Web Access)
- Password spray can be performed on OWA  via metasploit module.Follow the steps below:
  - sfconsole
  - search owa_login
  - use 6
  - Configured the options & start spraying.

# Attacking Web Portals
- Password spraying or credentials stuffing against other web portals such as auth.target.com, sso.target.com can be performed using tools such as burp, hydra, ffuf & many more.
  - Quick Note: There can be rate limit on the login portals . so , proper enumeration is the key before doing spray & pray. 
  
# Bypassing Multi-factor Authentication
- MFAsweep can be used  against micrsoft infrastructure to bypass 2FA/MFA :
   - https://github.com/dafthack/MFASweep
  
- Based on the given results via MFAsweep mailsniper can be used to bypass Exchange Web Services (EWS) :
   - https://github.com/dafthack/MailSniper

# Escalating Access
- **Initial Foothold:** Password Spraying against the O365 Accounts.
- **Enumeration:**  Enumerating the sensitive information in the mailbox such as VPN login portals, config files.
- **Post-exploitation:**
  - Trying to access to the VPN using credential stuffings, (breached credentials, default credentials ).
  -  Searching for the sensitive & official files of the victim organizations inside the sharepoint.
  -  Login the credentials into [portal.azure.com](http://portal.azure.com) & get some sensitive information.

# Report Writing
- After the assessment , proper report writing is also the important part. Below is the link sample of the pentest report provided by the TCM Security:
  - https://tcm-sec.com/wp-content/uploads/2021/10/TCMS-Demo-Corp-Security-Assessment-Findings-Report.pdf

# Common Pentest Findings:
- Follow the Provided link below for the sample findings for an external pentest:
  - https://vine-cardinal-454.notion.site/Common-Pentest-Findings-92ee999902b24c3ea8f525a2ee61522a
 
